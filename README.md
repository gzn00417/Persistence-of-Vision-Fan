> 论文下载：[知网链接](https://kns.cnki.net/KCMS/detail/detail.aspx?dbcode=CJFQ&dbname=CJFDAUTO&filename=WLWJ202001020&v=MTEzMTJUM3FUcldNMUZyQ1VSN3FmWStabkZ5em5WYnpPTWlIY1pMRzRITkhNcm85SFpJUjhlWDFMdXhZUzdEaDE=)
> 版权所有，有相关问题或索要完整代码实现请联系作者[gzn00417](https://blog.csdn.net/gzn00417)或邮箱`gzn00417@foxmail.com`

# 基于物联网的视觉暂留风扇设计

> 郭茁宁1，林亦宁2，何胜阳2
> 1. 哈尔滨工业大学计算机科学与技术学院，黑龙江 哈尔滨，150001
> 2. 哈尔滨工业大学电子与信息工程学院，黑龙江 哈尔滨，150001

# 摘要
- 为了丰富现有基于视觉暂留效应的风扇产品的展示效果，本文在深入研究电风扇视觉暂留原理的基础上，借助十六进制码的预存和动态平铺技术，将温湿度传感器所获得的实时数据在风扇上进行了显示。同时，设计了一款基于视觉暂留的“贪吃蛇”游戏，寓教于乐，丰富了风扇的功能。经过硬件电路的实际测试，风扇可以准确的显示温湿度，“贪吃蛇”游戏正常运行，达到了预期设计目标。
- 关键词：Arduino；物联网；视觉暂留；风扇；红外；DHT11；游戏
- 中图分类号:TP399       文献标识码: A

# 0 引言 
历史上最早使用视觉暂留效果的是电影的制作，电影屏幕上播出的图片速度为每秒25张图片，在视觉暂留现象的作用下，人眼会觉得这些间断性播出的图片是运动的。
目前，视觉暂留已经拥有了较为成熟的相关技术，存在利用视觉暂留实现3D效果的全息3D智能炫屏。市场角度，在南方每到七八月份，气温通常会在35摄氏度以上。而学校很少安装空调，因此便携式电扇在中小学生群体中有很大的市场。相比于普通的电扇，一款可以在扇面上形成滚动图案，甚至可以玩一些简单游戏的便携式电风扇显然在市场竞争上更占优势。
到目前为止，具有创新性的产品仍停留在“高大上”的层面。虽然有相关的成品，但对于普通用户不友好；此外，市场上现有存在的基于视觉暂留的小风扇产品仅仅利用简单的LED灯形成固定、单调的字样或图样。也正因如此激发了我们研究设计一种基于Arduino和视觉暂留技术的具有游戏体验的小风扇。该风扇应用的人群十分广泛，老少皆宜，小朋友可以同过游戏激发对科技的好奇心，老人可以通过游戏解闷，具有极大的潜力和广大的消费人群，可以说是一项非常新颖的风扇产品。
# 1 应用理论基础
## 1.1 物联网架构部署
- 感知层：物联网分为三层结构，在一个物联网系统中，感知层具有根基的作用，它能通过各种传感器的使用来检测和采集设定范围内环境的数据信息。本设计的感知层包括了红外和温湿度在内的传感器。
- 网络层：本设计的传输层主要由红外传输和温湿度传输组成。传输层的主要功能是为多个模块之间，在本项目中主要是为温湿度及红外模块提供它们与Arduino之间的通信服务。网络层的作用：一是为控制层提供有效的数据信息服务，二是及时地提供给用户有效的，实时的数据。
- 控制层：我们的项目是通过Arduino来实现对模块的控制的。实现过程中的编程是对其的编程是基于Arduino开源开发环境，可以兼容多种开发环境，其具有丰富的函数库可以调用。将所需的模块直接连接到其引脚上，包括红外收发模块、温湿度模块，我们直接调用其现有的源代码，并将重点放在游戏功能的实现上。
## 1.2 传感器
### 1.2.1 红外传感器：远程操控
红外通信成本低，体积小，仅需微小的发光二极管，模块化使用可以和Arduino很好的配合使用，大大简化的通信的难度。红外遥控器向红外接收器发射一系列二进制脉冲，发射的光信号在红外接收头内的接收器被转换成电信号，经过放大器的放大作用后，再进行滤波与解调，得到红外遥控器发出的原始脉冲。波形整形，并通过接收器的信号输出脚输入电器。红外通信本质来说，为对二进制脉冲码所代表的数字信号进行调制、解调的过程。
![Arduino与红外接收管连接电路](https://img-blog.csdnimg.cn/20200408153047962.png#pic_center)
### 1.2.2 温湿度传感器：实时监测
本项目融合了DHT11—一种把温度和湿度模块融为一体的高度集成的传感器，性价比高，响应迅速，抗干扰能力也很强，通过实时监测周围环境的温度湿度，产生不同的电压，并将电压的变化输给Arduino，对比分析传来的电信号，转换成温湿度信息，将实时监测到的温湿度的信息打印到风扇的LED流水灯上。
![Arduino与DHT11连接电路图](https://img-blog.csdnimg.cn/20200408153117503.png#pic_center)
## 1.3 视觉暂留理论
视觉暂留现象，物体反射周围的光并将其传入人眼之中，通过视网膜送入脑神经，光成像完成后，实物形成的图像不会瞬间消失，称为“后像”。Arduino能精确的控制时序，在这种效果之下，一列RBG流水灯不断地旋转，不断读取程序中的内容并通过闪烁频率的变化显示出预设的图形，文字和游戏界面。在我们的项目中能够在动态的旋转的风扇上形成静态的图形，和动态的游戏，动静结合是这个项目的一大亮点所在。
# 2 设计方案
## 2.1 创意与特点
### 2.1.1 “贪吃蛇”游戏功能：传统电器娱乐化
我们将视觉暂留技术与小游戏相结合，可以进行一些简单的小游戏。一般的贪吃蛇等游戏都要在普通的直方屏幕上进行，但这样的“屏幕”却超出了一般人的视野范围，富有传统设计没有的独特感官享受，清凉的同时带来别样的乐趣，风扇这一传统的电器能焕发出新时代的神奇魅力。
贪吃蛇的游戏设计：“上”、“下”、“左”、“右”四个方向分别可以通过对应的红外信号进行控制。 “视觉暂留风扇”的特色设计在于：
1. 它拥有环形的屏幕，可以做到普通直方屏幕难以实现的奇特、创新功能，在本次设计中它实现了贪吃蛇无限旋转的特色功能。
2. 它可以依据转速加快和减慢调节“显示屏幕”的长度，可以依据需要扩展和缩小屏幕。
3. 单色流水灯可以鲜明地显示，达到更富有冲击力的清爽的视觉效果。

![“贪吃蛇”游戏使用演示](https://img-blog.csdnimg.cn/20200408153153227.png#pic_center)

### 2.1.2 温湿度实时显示：创新形式展现大众化功能
风扇的使用建立在比较燥热的温湿度条件下，设计中，将温湿度传感器与风扇结合，利用“显示屏”将实时监测到的温度和湿度呈现出来。
利用旋转屏幕，可以显示“TEMP： XX”和“HUMI： XX”，这样可以使用户很直观地悉知周围的温度和湿度。这样的功能可以让已经在高温干燥中的用户更愿意使用风扇，提高产品效力，充分发挥其本质功能。

![温湿度实时显示使用演示](https://img-blog.csdnimg.cn/20200408153230625.png#pic_center)

## 2.2 物理与电子硬件框架
### 2.2.1 核心组成部件
风扇由Arduino核心板、电池、流水灯、扇叶、红外传感器、温湿度传感器、马达、变速器等电子元器件作为核心组成部件，构成基本物理框架，如图5所示，其中：
1. 马达：驱动风扇运转，连接在Arduino主板的下方；
2. 变速器：连接马达，调整转速，控制画布大小和调节稳定性，也可以设置顺时针或逆时针转动；
3. 红外遥控器：和红外传感器进行连接；
4. 流水灯：进行有规律闪烁，勾勒出设定图案；
5. 风扇主体：进行指定操作。

![核心组成部件概览图](https://img-blog.csdnimg.cn/20200408153309793.png#pic_center)

![风扇成品整体鸟瞰图](https://img-blog.csdnimg.cn/20200408153322849.png#pic_center)

### 2.2.2 流水灯“扇叶”与Arduino结合设计
8个二极管的流水灯在接上Arduino后，可以高速地有规则闪烁，随着周期和指令等自变量不同，可以在转动时显示出制定图形。
图6数字“8”的二进制码图像，对应编码为“0xFF，0x91，0x91，0xFF，0x00”；
有笔墨的地方设定为“1”，没有则设定为“0”，纵向8个格子进行压缩，从8位2进制码转换为2位16进制码，可以在Arduino的程序中用PORTD进行输出。

![数字“8”二进制码图像](https://img-blog.csdnimg.cn/20200408153350392.png#pic_center)

### 2.2.3 旋转的速度与平衡调试
在调整配重的基础上，风扇平衡旋转。将马达接上调速器，调节调速器的滑动变阻器，通过加快和减缓速度，能够实现扩张和收缩屏幕的效果。多组数据能够利用matplotlib在统计数据的基础上绘制出关于转速和宽度的直观散点图，并且进行拟合，研究出合适的转速和地图画布大小。

![风扇转速和屏幕宽度关系散点和拟合线图](https://img-blog.csdnimg.cn/20200408153409756.png#pic_center)

通过数据的测试、实际操作中视觉观看的舒适度、风扇平稳程度以及程序需要，我们选择了平行半径方向长度为8、垂直半径方向“屏幕宽度”（即表中的Width）为40的这一设定，并设置每次显示暂停2ms达到稳定清晰地效果。
## 2.3 软件程序开发
### 2.3.1 红外控制显示指定图像
这个功能是风扇最为基础的功能，它涉及到硬件和软件的结合，从传统风扇的单一功能过渡到了拥有可以多元化娱乐功能的条件。图9解释红外控制显示的实现流程：

![红外控制显示图像实现流程图](https://img-blog.csdnimg.cn/20200408153441947.png#pic_center)

### 2.3.2 “贪吃蛇”游戏实现
“贪吃蛇”游戏是电脑上最为基础的游戏之一，而在风扇上实现这一游戏无疑是传统电器娱乐化和科技化的重大突破。图10给出了“贪吃蛇”的实现流程。
首先导入红外库、设置端口；再解码红外16进制编码后进行预设储存；存储方式使用链表数据结构，流动储存蛇的身体坐标，模块化编程初始化链表，初始化地图，判断地图边界，创建新的食物等必要函数；蛇吃食物后，会创建新的食物，并且加长，也会应有4个不同的函数向四个方向移动；移动完成后，绘制、压缩地图，将地图转换为16进制码，打印地图，使流水灯闪烁，能够从视觉感官上看到蛇的运动；循环执行“贪吃蛇”游戏。
2.3.3 温湿度实时显示
温湿度实时显示，是在DHT11传感器接收、传输的基础上，结合流水灯的压缩输出，可以达到在风扇显示屏上显示出温度和湿度英文缩写字样以及所对应的数值。图11解释温湿度实时显示的实现流程：

![“贪吃蛇”游戏实现流程图](https://img-blog.csdnimg.cn/20200408153510604.png#pic_center)

![温湿度实时显示实现流程图](https://img-blog.csdnimg.cn/20200408153533336.png#pic_center)

首先导入基础库和温湿度函数库，初始化、设置频率9600；然后准备由pin10进行信号接收和传输：设置接口、检测响应结果、高电平则传输连接建立，设置pin2接口模式为Output，TX低电平20ms，RX高电平40μs与设置2号接口模式为Input，准备接收高电平响应信号，间歇性读取温湿度数值；在此之后运行读取bit1-40存储值；最后进行可视化的操作，格式转化输出：温度、湿度、校对码，温湿度显示的模块中预存储字母和数字的16进制编码、压缩图像、打印输出。

# 3 市场化和工业化设想
## 3.1 市场化
目前该领域市场上存在有相似的产品，主要面向广告，作为LED屏幕之外一个宣传形式的补充。而我们的设计则面向大众用户，提升风扇的娱乐性质，赋予风扇有别于传统概念的新奇形象。若我们的设计能面向市场，应该要有以下一些设计：
1. 设定面向的具体用户，比如儿童和老人，甚至针对不同的用户进行功能的补充以及概念的包装；
2. 提高设计的便携性和方便性；
3. 努力贴近现有风扇产品设计的特点，加速融入大众生活的速度；
4. 降低单个产品成本和售价，迎合普通用户；
在这样的技术市场化基础上，结合合理的商业模式，将超乎人们想象的设计带入人们的视野，尝试体验科技带来的魅力，这样一款市场化后的产品会为传统工业带来新的棉毛，风扇这一古老、单一的形象会在科技的光环下演绎出新一番的绚丽。
## 3.2 工业化
- 该风扇的功能实现依赖于底层的物理框架，对于物理框架的设计，有几点重要的特别考虑和实验成果：
1. 将Arduino核心主板和电池居中，且聚拢、减小距离，可以有效提高风扇旋转时的稳定性。
2. 用适当密度的等重材料板，与流水灯进行大小匹配，对称安装，在风扇旋转时大大减少振动和波动。
3. 采用直流电池，并将所有器件安装于核心板之上，避免在旋转时缠绕在一起。
4. 采用小马达，降低重心，有利于平衡。

- 若该设计能进入工业量产，以下几点需要加以改进和完善：
1. 缩小流水灯距离，使显示画面更加饱满、充实，尤其是显示贪吃蛇是纵向方向能连续显示。
2. 将红外居中，并置于容易接受信号的位置，能提高游戏操控的灵敏度。
3. 将马达嵌入，并且设置变速器，可以进行人工调试。
# 4 结语
- 在本项目研究中，设计了以视觉暂留为原理的电风扇，并且依据市面原有的产品原理进行改进和丰富功能，设计“贪吃蛇”游戏和温湿度显示等功能：以旋转的电风扇叶作为显示屏，富有区别于传统设计的独特感官享受，基于此设计的“贪吃蛇”配得上出彩的创意；将温湿度传感器与风扇结合，利用“显示屏”将传感器检测到的温度和湿度视觉上呈现出来。基于Arduino进行开发，充分利用了Arduino可延展性高、易于基础操作的特征。贪吃蛇的功能实现程序结合了游戏开发的嵌入式设计，以红外传感器作为传输游戏指令的媒介，进行创意的形式展现；温湿度显示功能借势潮流的启发，结合风扇和温湿度进行功能开发，运用单接口的物联技术和十六进制预存储动态传输技术完成实现。在研究结束时，指出了该风扇市场化的方向和拓展关键，以及工业化的改进方案的标准化预期设计，结合嵌入式设计和物联网结合的优势面向大众进行研究开发。总体来说，我们设计出拥有完整体系的物联网创新作品——“基于Arduino的智能人机交互风扇”，这项研究不但完成了突破传统印象的感官设计，更发挥了核心板潜在的功能运用，研究并结合了软件和嵌入式的功能实现，将一个新颖的风扇模型展示在消费者面前。
